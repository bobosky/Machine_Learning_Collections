<!DOCTYPE html>
<!-- saved from url=(0104)https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130 -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Sentiment Analysis with Variable length sequences in Pytorch</title><link rel="canonical" href="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130"><meta name="title" content="Sentiment Analysis with Variable length sequences in Pytorch"><meta name="referrer" content="always"><meta name="description" content="Recently I participated in a NLP competition on Kaggle where I finished in top 6%. As I am in the process of learning pytorch, I thought what better way to learn than to rewrite the code I have…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Sentiment Analysis with Variable length sequences in Pytorch"><meta property="twitter:title" content="Sentiment Analysis with Variable length sequences in Pytorch"><meta property="og:url" content="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="The Motivation"><meta name="twitter:description" content="The Motivation"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@sonicboom8"><meta property="author" content="Himanshu"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Himanshu"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2018-04-15T12:17:26.020Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="6 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/6241635ae130"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/6241635ae130"><meta property="al:android:url" content="medium://p/6241635ae130"><meta property="al:web:url" content="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/6241635ae130"><script async="" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/branch-latest.min.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1280,"height":720,"url":"https://cdn-images-1.medium.com/max/1408/1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg"},"url":"https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130","dateCreated":"2018-04-15T12:17:26.020Z","datePublished":"2018-04-15T12:17:26.020Z","dateModified":"2018-06-01T08:20:33.016Z","headline":"Sentiment Analysis with Variable length sequences in Pytorch","name":"Sentiment Analysis with Variable length sequences in Pytorch","thumbnailUrl":"https://cdn-images-1.medium.com/max/1408/1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg","keywords":["Tag:Machine Learning","Tag:Deep Learning","Tag:Pytorch","Tag:NLP","Tag:Sentiment Analysis","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"Himanshu","url":"https://medium.com/@sonicboom8"},"creator":["Himanshu"],"publisher":{"@type":"Organization","name":"Medium","url":"https://medium.com/","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https://cdn-images-1.medium.com/max/339/1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130"}</script><meta name="parsely-link" content="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="./Sentiment Analysis with Variable length sequences in Pytorch_files/m2.css"><link rel="stylesheet" href="./Sentiment Analysis with Variable length sequences in Pytorch_files/main-branding-base.SKBRHU_QJfaEkjWHhwLaJA.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlinesv-glyph v-glyph--m2 is-js is-withMagicUnderlines is-resizing" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--privacy" data-action-scope="_actionscope_1"><div class="butterBar-message"><div class="u-flexCenter u-justifyContentSpaceBetween u-paddingVertical12 u-maxWidth1000"><div class="u-flex1">Read <a class=" link--underline" href="https://medium.com/policy/f03bf92035c9" target="_blank">here</a> about Medium’s compliance with Do Not Track.</div><div class="u-flex0 u-textAlignRight u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon is-touched" data-action="butter-bar-dismiss"><span class="svgIcon svgIcon--removeThin svgIcon--19px"><svg class="svgIcon-use" width="19" height="19"><path d="M13.792 4.6l-4.29 4.29-4.29-4.29-.612.613 4.29 4.29-4.29 4.29.613.612 4.29-4.29 4.29 4.29.612-.613-4.29-4.29 4.29-4.29" fill-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="surface" id="_obv.shell._surface_1539585288738" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1294" height="610"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix js-metabar u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth"><div class="branch-journeys-top"></div><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1000 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20"><div class="metabar-block u-flex1 u-flexCenter"><div class="js-metabarLogoLeft u-xs-show"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo"><span class="svgIcon svgIcon--logoWordmark svgIcon--138x27px u-xs-hide u-flex"><svg class="svgIcon-use" width="138" height="27"><path d="M130 27V16.96c0-3.26-.154-5.472-2.437-5.472-1.16 0-2.138.57-2.863 1.512.217.906.3 1.968.3 3.127 0 2.247.036 5.11 0 7.973 0 .472-.046.58.244.87L127 27h-8V16.96c0-3.297-.461-5.472-2.708-5.472-1.16 0-1.64.653-2.292 1.595V24.1c0 .472-.026.58.3.87L116 27h-8V11.56c0-.47-.07-.579-.36-.905L106 9h8v3.612c.906-2.537 2.437-4.112 5.372-4.112 2.682 0 4.494 1.466 5.255 4.257.834-2.392 3.008-4.257 6.053-4.257 3.588 0 5.32 2.626 5.32 7.627 0 2.392.036 5.11 0 7.973 0 .472.004.652.25.87L138 27h-8zm-27-3.045c0 .472-.149.617.178.906L105 27h-8v-4c-.906 2.465-2.956 4-5.637 4C87.775 27 86 24.39 86 19.461c0-2.391-.036-5 0-7.936 0-.471-.11-.58-.4-.87L84 9h8v9.628c0 3.225.269 5.4 2.298 5.4 1.16 0 2.086-.725 2.702-1.63V11.56c0-.471-.129-.58-.419-.906L95 9h8v14.955zM78.002.25A3.248 3.248 0 0 1 81.25 3.5 3.25 3.25 0 1 1 78.002.25zM75 27V11.56c0-.47.168-.579-.122-.905L73 9h8v15.1c0 .472-.01.678.24.9L83 27h-8zM64 11.706c-.507-.652-1.418-1.123-2.396-1.123-1.957 0-3.842 1.775-3.842 7.03 0 4.93 1.631 6.669 3.66 6.669.907 0 1.853-.436 2.578-1.378V11.706zm6 12.286c0 .47-.026.58.3.87L72 27h-8v-3.697C62.913 25.804 60.951 27 58.632 27 54.5 27 51.5 23.738 51.5 17.795c0-5.582 3.254-9.314 7.784-9.314 2.356 0 3.919 1.123 4.716 2.899V3.878c0-.471-.077-.617-.403-.906L62 1.305 70 .29v23.702zM43.9 16c.037-.471.037-.67.037-.815 0-4.747-.937-5.435-2.437-5.435-1.5 0-2.854.995-2.927 6.25h5.328zm-5.327 1c0 4.711 2.392 6.63 5.183 6.63 2.174 0 4.313-.943 5.509-3.335h.072c-.942 4.566-3.77 6.705-8.01 6.705-4.566 0-8.879-2.755-8.879-9.133 0-6.705 4.277-9.386 9.097-9.386 3.842 0 7.937 1.811 7.937 7.646 0 .109 0 .438-.036.873H38.573zM31.5 27h-12l2.39-2.646c.084-.084.11-.399.11-.87V7l-7.866 20L5.581 8.372C5.364 7.9 5.181 7.285 5 6.777V20.62c0 .58-.035.653.364 1.196L9 27H0l3.64-5.183c.399-.543.36-.616.36-1.196V6.27c0-.617.095-.69-.195-1.051L1 1h8.495l7.355 16.3L23.24 1h8.26l-2.2 2.75c-.326.326-.3.599-.3 1.106v18.629c0 .47.005.75.138.87L31.5 27z"></path></svg></span><span class="svgIcon svgIcon--logoWordmark svgIcon--122x45px u-xs-show u-flex"><svg class="svgIcon-use" width="122" height="45"><path d="M61.6 31.806c0 .412 0 .505.28.758l1.574 1.537v.065h-6.979v-2.95a4.852 4.852 0 0 1-4.627 3.203c-3.588 0-6.192-2.81-6.192-7.981 0-4.843 2.81-8.075 6.754-8.075a4.122 4.122 0 0 1 4.056 2.51v-6.51a.806.806 0 0 0-.319-.787l-1.499-1.443v-.065l6.951-.815v20.553zm-5.125-.937v-9.714a2.614 2.614 0 0 0-2.08-.975c-1.695 0-3.334 1.537-3.334 6.099 0 4.271 1.414 5.78 3.175 5.78a2.81 2.81 0 0 0 2.24-1.19zm9.752 3.297V21.051a.88.88 0 0 0-.281-.786L64.4 18.672v-.065h6.98v13.302c0 .412 0 .505.28.758l1.536 1.443v.066l-6.97-.01zm-.253-20.356a2.81 2.81 0 1 1 5.62 0 2.81 2.81 0 0 1-5.62 0zm24.234 17.967c0 .413 0 .534.281.787l1.574 1.537v.065h-7.017v-3.363a5.077 5.077 0 0 1-4.805 3.616c-3.11 0-4.778-2.267-4.778-6.557 0-2.07 0-4.337.066-6.885a.796.796 0 0 0-.281-.76l-1.546-1.545v-.065h6.923v8.552c0 2.81.412 4.684 2.173 4.684a2.81 2.81 0 0 0 2.267-1.415v-9.367a.88.88 0 0 0-.28-.787l-1.556-1.602v-.065h6.979v13.17zm23.756 2.39c0-.507.094-6.952.094-8.432 0-2.81-.44-4.75-2.417-4.75a3.138 3.138 0 0 0-2.482 1.35c.198.876.292 1.772.28 2.67 0 1.948-.065 4.43-.093 6.913a.796.796 0 0 0 .281.759l1.574 1.442v.066h-7.045c0-.468.094-6.95.094-8.431 0-2.857-.44-4.75-2.389-4.75a2.81 2.81 0 0 0-2.323 1.387v9.555c0 .412 0 .506.281.759l1.537 1.442v.066h-6.97V21.098a.88.88 0 0 0-.281-.787l-1.546-1.639v-.065h6.98v3.334a5.002 5.002 0 0 1 5.002-3.587c2.323 0 3.896 1.292 4.562 3.747a5.433 5.433 0 0 1 5.245-3.747c3.11 0 4.872 2.295 4.872 6.632 0 2.07-.066 4.43-.094 6.913a.75.75 0 0 0 .318.759l1.537 1.443v.065h-7.017zm-87.671-2.043l2.07 1.977v.065H17.862v-.065l2.107-1.977a.796.796 0 0 0 .281-.759V18.728c0-.534 0-1.255.094-1.873l-7.082 17.564h-.084L5.843 18.26c-.16-.402-.206-.43-.31-.702v10.595c-.087.71.034 1.429.348 2.07l2.95 3.879v.065H1v-.065l2.95-3.888a3.69 3.69 0 0 0 .347-2.06v-11.71a2.267 2.267 0 0 0-.487-1.602l-2.089-2.708v-.065h7.494l6.277 13.686 5.527-13.686h7.335v.065l-2.061 2.296a.806.806 0 0 0-.319.786v16.15a.75.75 0 0 0 .319.759zm8.215-6.332v.065c0 4.01 2.07 5.62 4.497 5.62a5.105 5.105 0 0 0 4.777-2.894h.066c-.844 3.963-3.298 5.836-6.97 5.836-3.962 0-7.7-2.389-7.7-7.925 0-5.817 3.747-8.14 7.887-8.14 3.335 0 6.886 1.573 6.886 6.632v.806h-9.443zm0-.806h4.618v-.815c0-4.122-.852-5.218-2.136-5.218-1.555 0-2.5 1.64-2.5 6.033h.018z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><a class="button button--small button--chromeless u-baseColor--buttonNormal u-xs-hide js-upgradeMembershipAction" href="https://medium.com/upgrade?source=upgrade_membership---nav_full" data-scroll="native">Become a member</a></div><div class="metabar-block u-flex0"><div class="buttonSet buttonSet--wide"><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40sonicboom8%2Fsentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130&amp;source=--------------------------nav_reg&amp;operation=login" data-action="sign-in-prompt" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-action-source="--------------------------nav_reg">Sign in</a><a class="button button--primary button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40sonicboom8%2Fsentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130&amp;source=--------------------------nav_reg&amp;operation=register" data-action="sign-up-prompt" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-action-source="--------------------------nav_reg">Get started</a></div></div><div class="u-absolute u-width100pct u-top0 u-right0 u-bottom0 u-flexCenter u-justifyContentCenter u-textAlignCenter u-xs-hide js-metabarLogoCentered"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo"><span class="svgIcon svgIcon--logoWordmark svgIcon--138x27px u-xs-hide u-flex"><svg class="svgIcon-use" width="138" height="27"><path d="M130 27V16.96c0-3.26-.154-5.472-2.437-5.472-1.16 0-2.138.57-2.863 1.512.217.906.3 1.968.3 3.127 0 2.247.036 5.11 0 7.973 0 .472-.046.58.244.87L127 27h-8V16.96c0-3.297-.461-5.472-2.708-5.472-1.16 0-1.64.653-2.292 1.595V24.1c0 .472-.026.58.3.87L116 27h-8V11.56c0-.47-.07-.579-.36-.905L106 9h8v3.612c.906-2.537 2.437-4.112 5.372-4.112 2.682 0 4.494 1.466 5.255 4.257.834-2.392 3.008-4.257 6.053-4.257 3.588 0 5.32 2.626 5.32 7.627 0 2.392.036 5.11 0 7.973 0 .472.004.652.25.87L138 27h-8zm-27-3.045c0 .472-.149.617.178.906L105 27h-8v-4c-.906 2.465-2.956 4-5.637 4C87.775 27 86 24.39 86 19.461c0-2.391-.036-5 0-7.936 0-.471-.11-.58-.4-.87L84 9h8v9.628c0 3.225.269 5.4 2.298 5.4 1.16 0 2.086-.725 2.702-1.63V11.56c0-.471-.129-.58-.419-.906L95 9h8v14.955zM78.002.25A3.248 3.248 0 0 1 81.25 3.5 3.25 3.25 0 1 1 78.002.25zM75 27V11.56c0-.47.168-.579-.122-.905L73 9h8v15.1c0 .472-.01.678.24.9L83 27h-8zM64 11.706c-.507-.652-1.418-1.123-2.396-1.123-1.957 0-3.842 1.775-3.842 7.03 0 4.93 1.631 6.669 3.66 6.669.907 0 1.853-.436 2.578-1.378V11.706zm6 12.286c0 .47-.026.58.3.87L72 27h-8v-3.697C62.913 25.804 60.951 27 58.632 27 54.5 27 51.5 23.738 51.5 17.795c0-5.582 3.254-9.314 7.784-9.314 2.356 0 3.919 1.123 4.716 2.899V3.878c0-.471-.077-.617-.403-.906L62 1.305 70 .29v23.702zM43.9 16c.037-.471.037-.67.037-.815 0-4.747-.937-5.435-2.437-5.435-1.5 0-2.854.995-2.927 6.25h5.328zm-5.327 1c0 4.711 2.392 6.63 5.183 6.63 2.174 0 4.313-.943 5.509-3.335h.072c-.942 4.566-3.77 6.705-8.01 6.705-4.566 0-8.879-2.755-8.879-9.133 0-6.705 4.277-9.386 9.097-9.386 3.842 0 7.937 1.811 7.937 7.646 0 .109 0 .438-.036.873H38.573zM31.5 27h-12l2.39-2.646c.084-.084.11-.399.11-.87V7l-7.866 20L5.581 8.372C5.364 7.9 5.181 7.285 5 6.777V20.62c0 .58-.035.653.364 1.196L9 27H0l3.64-5.183c.399-.543.36-.616.36-1.196V6.27c0-.617.095-.69-.195-1.051L1 1h8.495l7.355 16.3L23.24 1h8.26l-2.2 2.75c-.326.326-.3.599-.3 1.106v18.629c0 .47.005.75.138.87L31.5 27z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full u-marginBottom40" lang="en"><header class="container u-maxWidth740"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaLockup postMetaLockup--authorWithBio u-flexCenter js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@sonicboom8?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="1f591fd38584" data-action-type="hover" data-user-id="1f591fd38584" dir="auto"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_mhNhw1OcFVtR_RA76EvM9w.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Himanshu"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-lineHeightTightest"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://medium.com/@sonicboom8?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="1f591fd38584" data-action-type="hover" data-user-id="1f591fd38584" dir="auto">Himanshu</a><span class="followState js-followState" data-user-id="1f591fd38584"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/1f591fd38584" data-action-source="post_header_lockup-1f591fd38584-------------------------follow_byline"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption ui-xs-clamp2 postMetaInline">Machine Learning / Deep Learning</div><div class="ui-caption postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2018-04-15T12:17:26.020Z">Apr 15</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="6 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="6241635ae130" data-source="post_page" data-tracking-context="postPage" data-scroll="native"><section name="abd5" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="fc81" id="fc81" class="graf graf--h3 graf--leading graf--trailing graf--title">Sentiment Analysis with Variable length sequences in&nbsp;Pytorch</h1></div></div></section><section name="a627" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="afc6" id="afc6" class="graf graf--h3 graf--leading">The Motivation</h3><p name="9b25" id="9b25" class="graf graf--p graf-after--h3">Recently I participated in a NLP <a href="https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge" data-href="https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">competition</a> on Kaggle where I finished in top 6%. As I am in the process of learning pytorch, I thought what better way to learn than to rewrite the code I have written in Keras for this competition.</p><blockquote name="7757" id="7757" class="graf graf--blockquote graf-after--p">This post focuses on how to implement sequence classification with variable lengths in pure pytorch.</blockquote><p name="1bdf" id="1bdf" class="graf graf--p graf-after--blockquote">Our final aim is to build a simple GRU model with <a href="https://arxiv.org/abs/1801.06146" data-href="https://arxiv.org/abs/1801.06146" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">concat pooling</a> [5]. fig [6]. For this post I will use Twitter Sentiment Analysis [1] dataset as this is a much easier dataset compared to the competition. Download dataset from [2].</p><p name="34f8" id="34f8" class="graf graf--p graf-after--p">Full code of this post is available <a href="https://github.com/hpanwar08/sentence-classification-pytorch" data-href="https://github.com/hpanwar08/sentence-classification-pytorch" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>.</p><h4 name="be03" id="be03" class="graf graf--h4 graf-after--p">Prerequisites</h4><ol class="postList"><li name="fac5" id="fac5" class="graf graf--li graf-after--h4">Basic knowledge of <a href="http://pytorch.org/" data-href="http://pytorch.org/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">Pytorch</a></li><li name="4524" id="4524" class="graf graf--li graf-after--li graf--trailing">Understanding of GRU/LSTM [4]</li></ol></div></div></section><section name="cf7c" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ec58" id="ec58" class="graf graf--h3 graf--leading">Simple Data&nbsp;Analysis</h3><p name="98ee" id="98ee" class="graf graf--p graf-after--h3">Data overview</p><figure name="49ed" id="49ed" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 551px; max-height: 191px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.699999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*adpPfDvsvSrCcH8R9zXnWA.png" data-width="551" data-height="191" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_adpPfDvsvSrCcH8R9zXnWA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="25"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*adpPfDvsvSrCcH8R9zXnWA.png" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_adpPfDvsvSrCcH8R9zXnWA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*adpPfDvsvSrCcH8R9zXnWA.png"></noscript></div></div><figcaption class="imageCaption">First 5 rows of&nbsp;data</figcaption></figure><p name="7839" id="7839" class="graf graf--p graf-after--figure">Let’s check the label distribution. Labels seems to be balanced.</p><figure name="1539" id="1539" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/dd355cf137c0ac3be4533cb02a43de72?postId=6241635ae130" data-media-id="dd355cf137c0ac3be4533cb02a43de72" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/dd355cf137c0ac3be4533cb02a43de72.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/dd355cf137c0ac3be4533cb02a43de72?postId=6241635ae130" data-media-id="dd355cf137c0ac3be4533cb02a43de72" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="5518" id="5518" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 522px; max-height: 320px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 61.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ecudoWNCFuX3Xi34nhzQrQ.png" data-width="522" data-height="320" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_ecudoWNCFuX3Xi34nhzQrQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="45"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*ecudoWNCFuX3Xi34nhzQrQ.png" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_ecudoWNCFuX3Xi34nhzQrQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*ecudoWNCFuX3Xi34nhzQrQ.png"></noscript></div></div><figcaption class="imageCaption">Fig [1] Labels distribution</figcaption></figure><h3 name="47e6" id="47e6" class="graf graf--h3 graf-after--figure">Start Simple</h3><p name="2327" id="2327" class="graf graf--p graf-after--h3">Let’s first build the vocab of all unique words in lowercase, then convert all the tweets to indexes and calculate length of each tweet.</p><figure name="eb1b" id="eb1b" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 118.286%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/c4370da553f0222c88aabe7942808a61?postId=6241635ae130" data-media-id="c4370da553f0222c88aabe7942808a61" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/c4370da553f0222c88aabe7942808a61.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/c4370da553f0222c88aabe7942808a61?postId=6241635ae130" data-media-id="c4370da553f0222c88aabe7942808a61" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="7aec" id="7aec" class="graf graf--p graf-after--figure">Check the lengths of the tweets after the tokenization.</p><figure name="550f" id="550f" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 523px; max-height: 320px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 61.199999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*I3idIQALuwLpi3UxABIp0Q.png" data-width="523" data-height="320" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_I3idIQALuwLpi3UxABIp0Q.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="45"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*I3idIQALuwLpi3UxABIp0Q.png" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_I3idIQALuwLpi3UxABIp0Q(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*I3idIQALuwLpi3UxABIp0Q.png"></noscript></div></div><figcaption class="imageCaption">Fig [2]</figcaption></figure><p name="da42" id="da42" class="graf graf--p graf-after--figure">Data after tokenization and replacing words with indexes.</p><figure name="ad48" id="ad48" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 150px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.4%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ITLl2BCdkzz1l6hM41HOYA.png" data-width="928" data-height="199" data-action="zoom" data-action-value="1*ITLl2BCdkzz1l6hM41HOYA.png" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_ITLl2BCdkzz1l6hM41HOYA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="15"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*ITLl2BCdkzz1l6hM41HOYA.png" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_ITLl2BCdkzz1l6hM41HOYA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*ITLl2BCdkzz1l6hM41HOYA.png"></noscript></div></div><figcaption class="imageCaption">Fig [3] Data view after tokenization and replacing words with&nbsp;indexes</figcaption></figure><h4 name="5647" id="5647" class="graf graf--h4 graf-after--figure">Time for creating a simple pytorch&nbsp;dataset</h4><p name="d1fc" id="d1fc" class="graf graf--p graf-after--h4">Pytorch provides convenience classes for creating custom dataset and dataloader. You can read about it <a href="http://pytorch.org/tutorials/beginner/data_loading_tutorial.html" data-href="http://pytorch.org/tutorials/beginner/data_loading_tutorial.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a> and <a href="http://pytorch.org/docs/stable/data.html" data-href="http://pytorch.org/docs/stable/data.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>.</p><figure name="2ddf" id="2ddf" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 93.429%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/06d093afceb4b11d4c7c29c9d308f7b6?postId=6241635ae130" data-media-id="06d093afceb4b11d4c7c29c9d308f7b6" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/06d093afceb4b11d4c7c29c9d308f7b6.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/06d093afceb4b11d4c7c29c9d308f7b6?postId=6241635ae130" data-media-id="06d093afceb4b11d4c7c29c9d308f7b6" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="952f" id="952f" class="graf graf--pre graf-after--figure">ds[:4] --&gt;</pre><pre name="e7ae" id="e7ae" class="graf graf--pre graf-after--pre">(0             [14, 26, 132, 18, 10, 241549, 266, 6621]                        1                       [2, 272, 7, 90, 812, 1274, 16]                        2                           [247, 82, 217, 4573, 1012]                        3    [37, 241550, 4, 2, 73, 440, 6, 2, 73, 1454, 55...                        </pre><pre name="56de" id="56de" class="graf graf--pre graf-after--pre">Name: sentimentidx, dtype: object,                         <br>0    0                        <br>1    0                        <br>2    1                        <br>3    0                        <br>Name: Sentiment, dtype: int64)</pre><p name="a26a" id="a26a" class="graf graf--p graf-after--pre">By using pytorch Dataloader we can use our custom dataset created above to load data in batched manner.</p><h3 name="786d" id="786d" class="graf graf--h3 graf-after--p">The Minor&nbsp;Details</h3><ul class="postList"><li name="102d" id="102d" class="graf graf--li graf-after--h3">If the data that comes out of the pytorch dataset is unpadded (if samples are of different lengths) then pytorch dataloader returns a python list instead of pytorch tensor with samples truncated to minimum length of the sample in the batch.</li></ul><p name="c5e4" id="c5e4" class="graf graf--p graf-after--li">In the code below, the output of the first batch i.e. first three samples are truncated to 5 (shortest tweet length in the batch) and returned as python list.</p><figure name="5467" id="5467" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 130.714%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/b4eefa456833fc5b8bee19e9e7bb8f62?postId=6241635ae130" data-media-id="b4eefa456833fc5b8bee19e9e7bb8f62" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/b4eefa456833fc5b8bee19e9e7bb8f62.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/b4eefa456833fc5b8bee19e9e7bb8f62?postId=6241635ae130" data-media-id="b4eefa456833fc5b8bee19e9e7bb8f62" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><h4 name="bf31" id="bf31" class="graf graf--h4 graf-after--figure">Solution:</h4><p name="e538" id="e538" class="graf graf--p graf-after--h4">Pad the dataset and calculate the lengths of the tweets. In the below code you can see the output of padded dataset and dataloader. Now samples are of equal lengths and output of dataloader is LongTensor.</p><p name="e1e8" id="e1e8" class="graf graf--p graf-after--p">Note: I have taken the max length as 10 and padded the tweets that are shorter than 10 with zeros (to the right) and truncated otherwise. We will require lengths of the tweets for the next step.</p><figure name="0207" id="0207" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 245%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/38e582ee1b4527a4c6688523b41d40dd?postId=6241635ae130" data-media-id="38e582ee1b4527a4c6688523b41d40dd" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/38e582ee1b4527a4c6688523b41d40dd.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/38e582ee1b4527a4c6688523b41d40dd?postId=6241635ae130" data-media-id="38e582ee1b4527a4c6688523b41d40dd" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><ul class="postList"><li name="0d28" id="0d28" class="graf graf--li graf-after--figure">To feed the variable length sequences to GRU we need to use pack_padded_sequence. To convert the output of GRU back to padded sequence, we use pad_packed_sequence. pack_padded_sequence require the batch to be sorted according to the lengths. Read about it <a href="http://pytorch.org/docs/stable/nn.html#pack-padded-sequence" data-href="http://pytorch.org/docs/stable/nn.html#pack-padded-sequence" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">here</a></li></ul><h4 name="bd38" id="bd38" class="graf graf--h4 graf-after--li">Our simple GRU&nbsp;model</h4></div><div class="section-inner sectionLayout--outsetColumn"><figure name="3c1c" id="3c1c" class="graf graf--figure graf--layoutOutsetCenter graf-after--h4" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 563px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*v-tLYQCsni550A-hznS0mw.jpeg" data-width="1280" data-height="720" data-action="zoom" data-action-value="1*v-tLYQCsni550A-hznS0mw.jpeg" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_v-tLYQCsni550A-hznS0mw.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="41"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/2000/1*v-tLYQCsni550A-hznS0mw.jpeg" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_v-tLYQCsni550A-hznS0mw(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/2000/1*v-tLYQCsni550A-hznS0mw.jpeg"></noscript></div></div><figcaption class="imageCaption">Fig [4] Simple GRU model by taking output of last hidden&nbsp;state</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><ul class="postList"><li name="d49c" id="d49c" class="graf graf--li graf-after--figure">Also, pytorch RNNs take batch in the shape of sequence_length x batch_size x n_hidden, so we have to transpose the batch after sorting. Refer sort_batch function in the below code.</li><li name="7b91" id="7b91" class="graf graf--li graf-after--li">The output of GRU/LSTM contains padded hidden states of all timesteps. If we take gru_out[-1] (i.e. last timestep from GRU output) then our result will contain zeros in the samples that are shorter than max length sample Fig [5]. Good thing is that the last hidden state contains all the last non zero output from GRU.</li></ul></div><div class="section-inner sectionLayout--outsetColumn"><figure name="b3e4" id="b3e4" class="graf graf--figure graf--layoutOutsetCenter graf-after--li" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 807px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 80.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*-agk_VMH0yu85UqKjWnVwA.jpeg" data-width="1354" data-height="1093" data-action="zoom" data-action-value="1*-agk_VMH0yu85UqKjWnVwA.jpeg" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_-agk_VMH0yu85UqKjWnVwA.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="60"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/2000/1*-agk_VMH0yu85UqKjWnVwA.jpeg" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_-agk_VMH0yu85UqKjWnVwA(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/2000/1*-agk_VMH0yu85UqKjWnVwA.jpeg"></noscript></div></div><figcaption class="imageCaption">Fig [5] GRU output and last hidden&nbsp;state</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><figure name="e7ad" id="e7ad" class="graf graf--figure graf--iframe graf-after--figure"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 192%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/6e0fe6085104358258ee0e1cc89d501a?postId=6241635ae130" data-media-id="6e0fe6085104358258ee0e1cc89d501a" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/6e0fe6085104358258ee0e1cc89d501a.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/6e0fe6085104358258ee0e1cc89d501a?postId=6241635ae130" data-media-id="6e0fe6085104358258ee0e1cc89d501a" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="b6fe" id="b6fe" class="graf graf--pre graf-after--figure">outp:<br>Variable containing:<br>-0.9536 -0.4867<br>-0.8185 -0.5818<br>-0.8788 -0.5366<br>[torch.FloatTensor of size 3x2]<br><br></pre><pre name="1da0" id="1da0" class="graf graf--pre graf-after--pre">torch.max(outp, dim=1):</pre><pre name="b6aa" id="b6aa" class="graf graf--pre graf-after--pre">(Variable containing:<br> -0.4867<br> -0.5818<br> -0.5366<br> [torch.FloatTensor of size 3], Variable containing:<br>  1<br>  1<br>  1<br> [torch.LongTensor of size 3])</pre><p name="6c16" id="6c16" class="graf graf--p graf-after--pre">Now we got the last output we can train our model. Refer training code on <a href="https://github.com/hpanwar08/sentence-classification-pytorch" data-href="https://github.com/hpanwar08/sentence-classification-pytorch" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>.</p><h3 name="e3c7" id="e3c7" class="graf graf--h3 graf-after--p">Our final objective is to build GRU model with <a href="https://arxiv.org/abs/1801.06146" data-href="https://arxiv.org/abs/1801.06146" class="markup--anchor markup--h3-anchor" rel="nofollow noopener" target="_blank">concat pooling</a>&nbsp;[5]</h3></div><div class="section-inner sectionLayout--outsetColumn"><figure name="431b" id="431b" class="graf graf--figure graf--layoutOutsetCenter graf-after--h3" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 563px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg" data-width="1280" data-height="720" data-is-featured="true" data-action="zoom" data-action-value="1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_qJggHpIPUkkzG0KQZ-EUcQ.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="41"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/2000/1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_qJggHpIPUkkzG0KQZ-EUcQ(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/2000/1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg"></noscript></div></div><figcaption class="imageCaption">Fig [6] GRU with <a href="https://arxiv.org/abs/1801.06146" data-href="https://arxiv.org/abs/1801.06146" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">concat pooling</a>&nbsp;[5]</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><blockquote name="b872" id="b872" class="graf graf--blockquote graf-after--figure">Concat Pooling in simple terms means taking max and average of output of all timesteps and then concatenating them along with the last hidden state before passing it is output layer. Refer Concat Pooling section in this <a href="https://arxiv.org/abs/1801.06146" data-href="https://arxiv.org/abs/1801.06146" class="markup--anchor markup--blockquote-anchor" rel="nofollow noopener" target="_blank">paper</a> [5].</blockquote><ul class="postList"><li name="70d6" id="70d6" class="graf graf--li graf-after--blockquote">We can pass the output of GRU to Adaptive Max pooling and Adaptive Avg pooling functions of pytorch. But there is a problem with this method.</li><li name="9ad5" id="9ad5" class="graf graf--li graf-after--li">Since GRU output is padded to longest length sample (fig [5]), the average taken by F.adaptive_avg_pool1d() maybe lower than the actual because the zero padding will also be accounted.</li><li name="3bab" id="3bab" class="graf graf--li graf-after--li">Similarly the max pooling taken by F.adaptive_max_pool1d() maybe higher than the actual because if the hidden state contains negative value then with zero padding, zero will be taken as max instead of negative value (refer output below)</li><li name="5a43" id="5a43" class="graf graf--li graf-after--li">I have calculated the actual max and avg pooling below (refer below code line 25, 33). I got a slight increase in accuracy compared to pytorch adaptive max./avg pooling, but my approach is quite slow. I don’t know if there exists an elegant solution to this.</li></ul><figure name="b5b2" id="b5b2" class="graf graf--figure graf--iframe graf-after--li"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 176.429%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/0273df26df01f64214f6f7ec62f5786f?postId=6241635ae130" data-media-id="0273df26df01f64214f6f7ec62f5786f" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/0273df26df01f64214f6f7ec62f5786f.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/0273df26df01f64214f6f7ec62f5786f?postId=6241635ae130" data-media-id="0273df26df01f64214f6f7ec62f5786f" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="ce07" id="ce07" class="graf graf--pre graf-after--figure">Adaptive avg pooling Variable containing:<br>-0.1657  0.3532 -0.2512 -0.0778 -0.5564<br> 0.2315  0.1153 -0.1446  0.3549 -0.0534<br> 0.1212  0.1945 -0.1012  0.2525 -0.1593<br>[torch.FloatTensor of size 3x5]<br><br>By hand Adaptive avg pooling Variable containing:<br>-0.1657  0.3532 -0.2512 -0.0778 -0.5564<br> 0.2646  0.1318 -0.1653  0.4056 -0.0610<br> 0.1939  0.3112 -0.1619  0.4040 -0.2549<br>[torch.FloatTensor of size 3x5]<br><br>Adaptive max pooling Variable containing:<br> 0.4062  0.5081  0.1206  0.2272 -0.0184<br> 0.5597  0.4545  0.2079  0.5897  0.4978<br> 0.3965  0.5072  0.1130  0.5585  0.0000<br>[torch.FloatTensor of size 3x5]<br><br>By hand Adaptive max pooling Variable containing:<br> 0.4062  0.5081  0.1206  0.2272 -0.0184<br> 0.5597  0.4545  0.2079  0.5897  0.4978<br> 0.3965  0.5072  0.1130  0.5585 -0.0092<br>[torch.FloatTensor of size 3x5]</pre><p name="4a60" id="4a60" class="graf graf--p graf-after--pre">You can compare the output of F.adaptive_max_pool1d() and max pooling by hand (custom code) in the above output. The max pooling by hand contains negative value as the max value while it is zero with F.adaptive_max_pool1d().</p><h4 name="43f8" id="43f8" class="graf graf--h4 graf-after--p">Ways to improve&nbsp;accuracy</h4><p name="a3e9" id="a3e9" class="graf graf--p graf-after--h4">The accuracy I got on training set with above setup is ~81%. There are a lot of ways to improve it.</p><ul class="postList"><li name="feac" id="feac" class="graf graf--li graf-after--p">Include validation set for better accuracy measure</li><li name="fd02" id="fd02" class="graf graf--li graf-after--li">Better preprocessing</li><li name="e04a" id="e04a" class="graf graf--li graf-after--li">More hidden units</li><li name="2906" id="2906" class="graf graf--li graf-after--li">Pretrained word/char embeddings e.g. Glove, Fasttext, Word2vec</li><li name="d520" id="d520" class="graf graf--li graf-after--li">Regularization e.g. Dropout</li><li name="0ea0" id="0ea0" class="graf graf--li graf-after--li">Better model e.g. Bidirectional GRU, GRU with attention</li></ul><blockquote name="219b" id="219b" class="graf graf--blockquote graf-after--li">In the <a href="https://medium.com/@sonicboom8/sentiment-analysis-torchtext-55fb57b1fab8" data-href="https://medium.com/@sonicboom8/sentiment-analysis-torchtext-55fb57b1fab8" class="markup--anchor markup--blockquote-anchor" target="_blank">next post</a> I will cover Pytorch Text (torchtext) and how it can solve some of the problems we faced with much less code. Also, I will include the above mentioned tips to improve accuracy.</blockquote><p name="61c3" id="61c3" class="graf graf--p graf-after--blockquote">This is my first blog post. Please correct me if you find any mistake or if I have left out any reference.</p><h3 name="9bbf" id="9bbf" class="graf graf--h3 graf-after--p">References</h3><p name="8104" id="8104" class="graf graf--p graf-after--h3 graf--trailing">[1] <a href="http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/" data-href="http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/</a>&nbsp;<br>[2] <a href="http://thinknook.com/wp-content/uploads/2012/09/Sentiment-Analysis-Dataset.zip" data-href="http://thinknook.com/wp-content/uploads/2012/09/Sentiment-Analysis-Dataset.zip" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">http://thinknook.com/wp-content/uploads/2012/09/Sentiment-Analysis-Dataset.zip</a>&nbsp;<br>[3] <a href="https://stackoverflow.com/questions/46387661/how-to-correctly-implement-a-batch-input-lstm-network-in-pytorch" data-href="https://stackoverflow.com/questions/46387661/how-to-correctly-implement-a-batch-input-lstm-network-in-pytorch" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://stackoverflow.com/questions/46387661/how-to-correctly-implement-a-batch-input-lstm-network-in-pytorch</a>&nbsp;<br>[4] <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" data-href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a>&nbsp;<br>[5] <a href="https://arxiv.org/abs/1801.06146" data-href="https://arxiv.org/abs/1801.06146" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://arxiv.org/abs/1801.06146</a></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"><div class="postMetaInline postMetaInline--acknowledgments u-paddingTop5 u-paddingBottom20 js-postMetaAcknowledgments"><a class="link u-baseColor--link" href="http://creativecommons.org/licenses/by/4.0/" rel="license cc:license" target="_blank" data-tooltip="Except where otherwise noted, this work is licensed under a Creative Commons Attribution 4.0 International license by the author.">Some rights reserved</a><span class="postMetaInline-licenseIcons u-marginLeft5"><span title="You can distribute, remix, and build upon this work as long as you credit the author."><span class="svgIcon svgIcon--creativeCommonsBy svgIcon--21px"><svg class="svgIcon-use" width="21" height="21"><path d="M10.485 2c2.387 0 4.4.82 6.04 2.46C18.175 6.107 19 8.12 19 10.5c0 2.388-.81 4.376-2.43 5.965C14.85 18.155 12.823 19 10.486 19c-2.298 0-4.29-.835-5.98-2.505C2.836 14.825 2 12.827 2 10.5s.835-4.34 2.505-6.04C6.145 2.82 8.137 2 10.485 2zm.03 1.533c-1.933 0-3.567.678-4.903 2.034-1.386 1.417-2.08 3.06-2.08 4.933 0 1.882.69 3.512 2.065 4.887 1.376 1.377 3.015 2.064 4.918 2.064 1.892 0 3.54-.69 4.948-2.07 1.336-1.28 2.004-2.91 2.004-4.87 0-1.93-.68-3.57-2.034-4.93-1.356-1.35-2.995-2.03-4.918-2.03zm2.277 4.857v3.476h-.97v4.128H9.18v-4.128h-.972V8.39a.53.53 0 0 1 .16-.387.528.528 0 0 1 .387-.16h3.49c.143 0 .27.054.38.16a.52.52 0 0 1 .167.387zM9.316 6.205c0-.8.394-1.2 1.184-1.2.79 0 1.184.4 1.184 1.2 0 .79-.395 1.183-1.184 1.183-.79 0-1.184-.394-1.184-1.183z" fill-rule="evenodd"></path></svg></span></span></span> </div></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/deep-learning?source=post" data-action-source="post">Deep Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/pytorch?source=post" data-action-source="post">Pytorch</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/nlp?source=post" data-action-source="post">NLP</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/sentiment-analysis?source=post" data-action-source="post">Sentiment Analysis</a></li></ul></div></div></div><div class="postActions js-postActionsFooter"><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter u-width60" data-post-id="6241635ae130" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----6241635ae130---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboarding" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/6241635ae130" data-action-source="post_actions_footer-----6241635ae130---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="6241635ae130"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="6241635ae130">21</button></span></div></div><div class="buttonSet u-flex0"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="scroll-to-responses">2</button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton" title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="1f591fd38584"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/1f591fd38584" data-action-source="footer_card-1f591fd38584-------------------------follow_footer"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar" href="https://medium.com/@sonicboom8?source=footer_card" title="Go to the profile of Himanshu" aria-label="Go to the profile of Himanshu" data-action-source="footer_card" data-user-id="1f591fd38584" dir="auto"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_mhNhw1OcFVtR_RA76EvM9w.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Himanshu"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@sonicboom8" property="cc:attributionName" title="Go to the profile of Himanshu" aria-label="Go to the profile of Himanshu" rel="author cc:attributionUrl" data-user-id="1f591fd38584" dir="auto">Himanshu</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Machine Learning / Deep Learning</p></div></li></div></div></div><div class="js-postFooterPlacements"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="ae7e74410795" data-source="placement_card_footer_grid---------0-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://towardsdatascience.com/lets-code-a-neural-network-in-plain-numpy-ae7e74410795?source=placement_card_footer_grid---------0-43" data-action-source="placement_card_footer_grid---------0-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/440/132/1*fiYPinouczFoVeB6KYqs9Q.gif&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://towardsdatascience.com/lets-code-a-neural-network-in-plain-numpy-ae7e74410795?source=placement_card_footer_grid---------0-43" data-action-source="placement_card_footer_grid---------0-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Deep Learning</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Let’s code a Neural Network in plain NumPy</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://towardsdatascience.com/@piotr.skalski92" data-action="show-user-card" data-action-value="11b65705ec0" data-action-type="hover" data-user-id="11b65705ec0" data-collection-slug="towards-data-science" dir="auto"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_uLFtOD_rwfKeLDbWIEly8g.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Piotr Skalski"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://towardsdatascience.com/@piotr.skalski92?source=placement_card_footer_grid---------0-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-43" data-action-value="11b65705ec0" data-action-type="hover" data-user-id="11b65705ec0" data-collection-slug="towards-data-science" dir="auto">Piotr Skalski</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="10 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="ae7e74410795" data-is-label-padded="true" data-source="placement_card_footer_grid-----ae7e74410795----0-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/ae7e74410795" data-action-source="placement_card_footer_grid-----ae7e74410795----0-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="ae7e74410795">1K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/ae7e74410795" data-action-source="placement_card_footer_grid-----ae7e74410795----0-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="678c51b4b463" data-source="placement_card_footer_grid---------1-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://becominghuman.ai/cheat-sheets-for-ai-neural-networks-machine-learning-deep-learning-big-data-678c51b4b463?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/440/132/1*gccuMDV8fXjcvz1RSk4kgQ.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://becominghuman.ai/cheat-sheets-for-ai-neural-networks-machine-learning-deep-learning-big-data-678c51b4b463?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Deep Learning</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Cheat Sheets for AI, Neural Networks, Machine Learning, Deep Learning &amp; Big Data</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://becominghuman.ai/@kojouharov" data-action="show-user-card" data-action-value="67c8653ca7e2" data-action-type="hover" data-user-id="67c8653ca7e2" data-collection-slug="becoming-human" dir="auto"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/0_OkBJcTtzRepyvKMl" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Stefan Kojouharov"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://becominghuman.ai/@kojouharov?source=placement_card_footer_grid---------1-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-43" data-action-value="67c8653ca7e2" data-action-type="hover" data-user-id="67c8653ca7e2" data-collection-slug="becoming-human" dir="auto">Stefan Kojouharov</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="7 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="678c51b4b463" data-is-label-padded="true" data-source="placement_card_footer_grid-----678c51b4b463----1-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/678c51b4b463" data-action-source="placement_card_footer_grid-----678c51b4b463----1-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="678c51b4b463">37K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/678c51b4b463" data-action-source="placement_card_footer_grid-----678c51b4b463----1-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="baf6b8fc4c5f" data-source="placement_card_footer_grid---------2-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://towardsdatascience.com/self-learning-ai-agents-part-i-markov-decision-processes-baf6b8fc4c5f?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/440/132/1*aqp94KVRB72uoFWAjVAgWg.gif&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://towardsdatascience.com/self-learning-ai-agents-part-i-markov-decision-processes-baf6b8fc4c5f?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Deep Learning</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Self Learning AI-Agents Part I: Markov Decision Processes</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://towardsdatascience.com/@artem.oppermann" data-action="show-user-card" data-action-value="619319ac8220" data-action-type="hover" data-user-id="619319ac8220" data-collection-slug="towards-data-science" dir="auto"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_EZsxrXJP6KvT8-xZ0gx8Gg.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Artem Oppermann"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://towardsdatascience.com/@artem.oppermann?source=placement_card_footer_grid---------2-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-43" data-action-value="619319ac8220" data-action-type="hover" data-user-id="619319ac8220" data-collection-slug="towards-data-science" dir="auto">Artem Oppermann</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="11 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="baf6b8fc4c5f" data-is-label-padded="true" data-source="placement_card_footer_grid-----baf6b8fc4c5f----2-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/baf6b8fc4c5f" data-action-source="placement_card_footer_grid-----baf6b8fc4c5f----2-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="baf6b8fc4c5f">348</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/baf6b8fc4c5f" data-action-source="placement_card_footer_grid-----baf6b8fc4c5f----2-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom20 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="u-paddingTop30 u-paddingBottom30 u-paddingLeft0 u-paddingRight0 u-borderBottomLightest js-responsesLoggedOutPrompt"><button class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-up-prompt" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130#--respond" data-skip-onboarding="true" data-action-source="logged_out_response_prompt--------------------------respond_box"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div><div class="responsesStream js-responsesStream"></div><div class="container js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-width100pct u-marginVertical20 u-heightAuto" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1000 js-postLeftSidebar"><div class="u-foreground u-top0 u-fixed u-sm-hide u-marginLeftNegative12 js-postShareWidget u-transition--fadeIn300" data-scroll="fixed" style="transform: translateY(150px);"><ul><li class="u-textAlignCenter u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexColumn u-marginBottom10 u-width60" data-post-id="6241635ae130" data-is-icon-29px="true" data-is-vertical="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_share_widget-----6241635ae130---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/6241635ae130" data-action-source="post_share_widget-----6241635ae130---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="6241635ae130"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-flexOrderNegative1 u-height20 u-marginBottom7"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-block u-marginAuto" data-action="show-recommends" data-action-value="6241635ae130">21</button></span></div></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/6241635ae130" data-action-source="post_share_widget-----6241635ae130---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></aside><div class="u-fixed u-bottom0 u-width100pct u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link u-baseColor--link avatar u-inline" href="https://medium.com/@sonicboom8" data-action="show-user-card" data-action-value="1f591fd38584" data-action-type="hover" data-user-id="1f591fd38584" dir="auto"><img src="./Sentiment Analysis with Variable length sequences in Pytorch_files/1_mhNhw1OcFVtR_RA76EvM9w(1).jpeg" class="avatar-image avatar-image--smaller" alt="Go to the profile of Himanshu"></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> Himanshu</strong>, when you sign up for Medium. <a class="link u-baseColor--link link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> Himanshu</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><span class="followState js-followState" data-user-id="1f591fd38584"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-action-source="sticky_footer"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/1f591fd38584" data-action-source="sticky_footer-1f591fd38584-------------------------follow_metabar"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Get updates</span></button></span></div></div></div><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-up-prompt" data-sign-in-action="quote" data-requires-token="true" data-skip-onboarding="true" data-redirect-type="quote" data-action-source="quote_menu--------------------------highlight_text"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="quote-respond" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-skip-onboarding="true" data-action-source="quote_menu--------------------------respond_text"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="twitter" data-action-source="quote_menu" data-skip-onboarding="true"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="highlight" data-redirect="https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130" data-skip-onboarding="true" data-action-source="quote_menu--------------------------privatenote_text"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"35307","currentUser":{"userId":"lo_dnt_K1OZNZxyCXTi","isVerified":false,"subscriberEmail":"","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":false,"isWriterProgramInvited":false,"isWriterProgramOptedOut":false,"writerProgramVersion":0,"writerProgramEnrolledAt":0},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.DriHnOl5qMKpR8tHbofmcA.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.ybn8pINumuGVGI-wY651qA.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.RdmouXxzpnD6Di-AAPUFXg.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.C1bohrv3d8mYSVO18qh1Ow.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.0Ri1F4jkO2OK26eWElMpZg.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.4Hcf4I6qAbwXHFjEyhPyAg.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.5yJlJWytjSGaFCSBc6yR4A.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.BW0TiDBWHCWGHNn1dQ4L_w.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.I2GpRgPVJYyqYWo-_Rs2dA.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.YDIr1fQWRjDWZWEmhruWzQ.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.gQ-c6dyV_oLWqn-obN1SYg.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1539585286894:5ef664eee159","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":69,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":5,"isSearchBot":false,"isSyndicationBot":false,"isNativeAndroid":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_paypal_delinquency_handling":true,"enable_post_monger_v2":true,"enable_post_monger_v3":true,"enable_star_meter_ui":true,"max_premium_content_per_user_under_metering":3,"enable_metered_out_email":true,"enable_automated_mission_control_triggers":true,"enable_top_stories_for_you":true,"enable_ios_member_post_labeling":true,"enable_lite_profile":true,"enable_signin_wall_custom_domain":true,"app_download_email_template":"control","enable_topic_lifecycle_email":true,"enable_marketing_emails":true,"enable_truncated_rss_for_tags_and_topics":true,"enable_rex_service_featured_posts":true,"enable_parsely":true,"enable_branch_io":true,"enable_synchronous_parsely":true,"enable_post_stats_page":true,"enable_ios_post_stats":true,"enable_reader_interests":true,"enable_post_stats_page_new_milestones":true,"enable_prepublish_flow_2_everyone":true,"enable_lite_topics":true,"enable_lite_stories":true,"enable_lite_billing_history":true,"redis_read_write_splitting":true,"enable_tipalti_onboarding":true,"enable_sift_integration":true,"enable_sift_science_webhook":true,"enable_quality_assurance_queue":true,"enable_writer_controls":true,"enable_partner_dashboard_tax_link":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"},{"id":10,"url":"https://glyph.medium.com/css/elv8.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":true,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email"],"connect":["public_profile","email"],"login":["public_profile","email"],"share":["public_profile","email"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":4,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"lo_post_page_4","type":0,"url":"www.calendly.com"},{"promptId":"lo_home_page","type":1,"url":"www.calendly.com"},{"promptId":"lo_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","paypalClientMode":"production","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"US","bypassMeter":false,"branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm"}
// ]]></script><script charset="UTF-8" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/main-base.bundle.DriHnOl5qMKpR8tHbofmcA.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"6241635ae130","versionId":"149f45c6b6b2","creatorId":"1f591fd38584","creator":{"userId":"1f591fd38584","name":"Himanshu","username":"sonicboom8","createdAt":1499184020948,"lastPostCreatedAt":1534333182174,"imageId":"1*mhNhw1OcFVtR_RA76EvM9w.jpeg","backgroundImageId":"","bio":"Machine Learning / Deep Learning","twitterScreenName":"","socialStats":{"userId":"1f591fd38584","usersFollowedCount":23,"usersFollowedByCount":16,"type":"SocialStats"},"social":{"userId":"lo_dnt_K1OZNZxyCXTi","targetUserId":"1f591fd38584","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isPartnerProgramEnrolled":false,"type":"User"},"homeCollectionId":"","title":"Sentiment Analysis with Variable length sequences in Pytorch","detectedLanguage":"en","latestVersion":"149f45c6b6b2","latestPublishedVersion":"149f45c6b6b2","hasUnpublishedEdits":false,"latestRev":1476,"createdAt":1523278649659,"updatedAt":1527841233016,"acceptedAt":0,"firstPublishedAt":1523794646020,"latestPublishedAt":1524931148579,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"The Motivation","bodyModel":{"paragraphs":[{"name":"fc81","type":3,"text":"Sentiment Analysis with Variable length sequences in Pytorch","markups":[]},{"name":"afc6","type":3,"text":"The Motivation","markups":[]},{"name":"9b25","type":1,"text":"Recently I participated in a NLP competition on Kaggle where I finished in top 6%. As I am in the process of learning pytorch, I thought what better way to learn than to rewrite the code I have written in Keras for this competition.","markups":[{"type":3,"start":33,"end":44,"href":"https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge","title":"","rel":"","anchorType":0}]},{"name":"7757","type":6,"text":"This post focuses on how to implement sequence classification with variable lengths in pure pytorch.","markups":[]},{"name":"1bdf","type":1,"text":"Our final aim is to build a simple GRU model with concat pooling [5]. fig [6]. For this post I will use Twitter Sentiment Analysis [1] dataset as this is a much easier dataset compared to the competition. Download dataset from [2].","markups":[{"type":3,"start":50,"end":64,"href":"https://arxiv.org/abs/1801.06146","title":"","rel":"","anchorType":0}]},{"name":"34f8","type":1,"text":"Full code of this post is available here.","markups":[{"type":3,"start":36,"end":40,"href":"https://github.com/hpanwar08/sentence-classification-pytorch","title":"","rel":"","anchorType":0}]},{"name":"be03","type":13,"text":"Prerequisites","markups":[]},{"name":"fac5","type":10,"text":"Basic knowledge of Pytorch","markups":[{"type":3,"start":19,"end":26,"href":"http://pytorch.org/","title":"","rel":"","anchorType":0}]},{"name":"4524","type":10,"text":"Understanding of GRU/LSTM [4]","markups":[]},{"name":"ec58","type":3,"text":"Simple Data Analysis","markups":[]},{"name":"98ee","type":1,"text":"Data overview","markups":[]},{"name":"49ed","type":4,"text":"First 5 rows of data","markups":[],"layout":1,"metadata":{"id":"1*adpPfDvsvSrCcH8R9zXnWA.png","originalWidth":551,"originalHeight":191}},{"name":"7839","type":1,"text":"Let’s check the label distribution. Labels seems to be balanced.","markups":[]},{"name":"1539","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"dd355cf137c0ac3be4533cb02a43de72","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"5518","type":4,"text":"Fig [1] Labels distribution","markups":[],"layout":1,"metadata":{"id":"1*ecudoWNCFuX3Xi34nhzQrQ.png","originalWidth":522,"originalHeight":320}},{"name":"47e6","type":3,"text":"Start Simple","markups":[]},{"name":"2327","type":1,"text":"Let’s first build the vocab of all unique words in lowercase, then convert all the tweets to indexes and calculate length of each tweet.","markups":[]},{"name":"eb1b","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"c4370da553f0222c88aabe7942808a61","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"7aec","type":1,"text":"Check the lengths of the tweets after the tokenization.","markups":[]},{"name":"550f","type":4,"text":"Fig [2]","markups":[],"layout":1,"metadata":{"id":"1*I3idIQALuwLpi3UxABIp0Q.png","originalWidth":523,"originalHeight":320}},{"name":"da42","type":1,"text":"Data after tokenization and replacing words with indexes.","markups":[]},{"name":"ad48","type":4,"text":"Fig [3] Data view after tokenization and replacing words with indexes","markups":[],"layout":1,"metadata":{"id":"1*ITLl2BCdkzz1l6hM41HOYA.png","originalWidth":928,"originalHeight":199}},{"name":"5647","type":13,"text":"Time for creating a simple pytorch dataset","markups":[]},{"name":"d1fc","type":1,"text":"Pytorch provides convenience classes for creating custom dataset and dataloader. You can read about it here and here.","markups":[{"type":3,"start":103,"end":107,"href":"http://pytorch.org/tutorials/beginner/data_loading_tutorial.html","title":"","rel":"","anchorType":0},{"type":3,"start":112,"end":116,"href":"http://pytorch.org/docs/stable/data.html","title":"","rel":"","anchorType":0}]},{"name":"2ddf","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"06d093afceb4b11d4c7c29c9d308f7b6","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"952f","type":8,"text":"ds[:4] --\x3e","markups":[]},{"name":"e7ae","type":8,"text":"(0             [14, 26, 132, 18, 10, 241549, 266, 6621]                        1                       [2, 272, 7, 90, 812, 1274, 16]                        2                           [247, 82, 217, 4573, 1012]                        3    [37, 241550, 4, 2, 73, 440, 6, 2, 73, 1454, 55...                        ","markups":[]},{"name":"56de","type":8,"text":"Name: sentimentidx, dtype: object,                         \n0    0                        \n1    0                        \n2    1                        \n3    0                        \nName: Sentiment, dtype: int64)","markups":[]},{"name":"a26a","type":1,"text":"By using pytorch Dataloader we can use our custom dataset created above to load data in batched manner.","markups":[]},{"name":"786d","type":3,"text":"The Minor Details","markups":[]},{"name":"102d","type":9,"text":"If the data that comes out of the pytorch dataset is unpadded (if samples are of different lengths) then pytorch dataloader returns a python list instead of pytorch tensor with samples truncated to minimum length of the sample in the batch.","markups":[]},{"name":"c5e4","type":1,"text":"In the code below, the output of the first batch i.e. first three samples are truncated to 5 (shortest tweet length in the batch) and returned as python list.","markups":[]},{"name":"5467","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"b4eefa456833fc5b8bee19e9e7bb8f62","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"bf31","type":13,"text":"Solution:","markups":[]},{"name":"e538","type":1,"text":"Pad the dataset and calculate the lengths of the tweets. In the below code you can see the output of padded dataset and dataloader. Now samples are of equal lengths and output of dataloader is LongTensor.","markups":[]},{"name":"e1e8","type":1,"text":"Note: I have taken the max length as 10 and padded the tweets that are shorter than 10 with zeros (to the right) and truncated otherwise. We will require lengths of the tweets for the next step.","markups":[]},{"name":"0207","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"38e582ee1b4527a4c6688523b41d40dd","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"0d28","type":9,"text":"To feed the variable length sequences to GRU we need to use pack_padded_sequence. To convert the output of GRU back to padded sequence, we use pad_packed_sequence. pack_padded_sequence require the batch to be sorted according to the lengths. Read about it here","markups":[{"type":3,"start":256,"end":260,"href":"http://pytorch.org/docs/stable/nn.html#pack-padded-sequence","title":"","rel":"","anchorType":0}]},{"name":"bd38","type":13,"text":"Our simple GRU model","markups":[]},{"name":"3c1c","type":4,"text":"Fig [4] Simple GRU model by taking output of last hidden state","markups":[],"layout":3,"metadata":{"id":"1*v-tLYQCsni550A-hznS0mw.jpeg","originalWidth":1280,"originalHeight":720}},{"name":"d49c","type":9,"text":"Also, pytorch RNNs take batch in the shape of sequence_length x batch_size x n_hidden, so we have to transpose the batch after sorting. Refer sort_batch function in the below code.","markups":[]},{"name":"7b91","type":9,"text":"The output of GRU/LSTM contains padded hidden states of all timesteps. If we take gru_out[-1] (i.e. last timestep from GRU output) then our result will contain zeros in the samples that are shorter than max length sample Fig [5]. Good thing is that the last hidden state contains all the last non zero output from GRU.","markups":[]},{"name":"b3e4","type":4,"text":"Fig [5] GRU output and last hidden state","markups":[],"layout":3,"metadata":{"id":"1*-agk_VMH0yu85UqKjWnVwA.jpeg","originalWidth":1354,"originalHeight":1093}},{"name":"e7ad","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"6e0fe6085104358258ee0e1cc89d501a","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"b6fe","type":8,"text":"outp:\nVariable containing:\n-0.9536 -0.4867\n-0.8185 -0.5818\n-0.8788 -0.5366\n[torch.FloatTensor of size 3x2]\n","markups":[]},{"name":"1da0","type":8,"text":"torch.max(outp, dim=1):","markups":[]},{"name":"b6aa","type":8,"text":"(Variable containing:\n -0.4867\n -0.5818\n -0.5366\n [torch.FloatTensor of size 3], Variable containing:\n  1\n  1\n  1\n [torch.LongTensor of size 3])","markups":[]},{"name":"6c16","type":1,"text":"Now we got the last output we can train our model. Refer training code on here.","markups":[{"type":3,"start":74,"end":78,"href":"https://github.com/hpanwar08/sentence-classification-pytorch","title":"","rel":"","anchorType":0}]},{"name":"e3c7","type":3,"text":"Our final objective is to build GRU model with concat pooling [5]","markups":[{"type":3,"start":47,"end":61,"href":"https://arxiv.org/abs/1801.06146","title":"","rel":"","anchorType":0}]},{"name":"431b","type":4,"text":"Fig [6] GRU with concat pooling [5]","markups":[{"type":3,"start":17,"end":31,"href":"https://arxiv.org/abs/1801.06146","title":"","rel":"","anchorType":0}],"layout":3,"metadata":{"id":"1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg","originalWidth":1280,"originalHeight":720,"isFeatured":true}},{"name":"b872","type":6,"text":"Concat Pooling in simple terms means taking max and average of output of all timesteps and then concatenating them along with the last hidden state before passing it is output layer. Refer Concat Pooling section in this paper [5].","markups":[{"type":3,"start":220,"end":225,"href":"https://arxiv.org/abs/1801.06146","title":"","rel":"","anchorType":0}]},{"name":"70d6","type":9,"text":"We can pass the output of GRU to Adaptive Max pooling and Adaptive Avg pooling functions of pytorch. But there is a problem with this method.","markups":[]},{"name":"9ad5","type":9,"text":"Since GRU output is padded to longest length sample (fig [5]), the average taken by F.adaptive_avg_pool1d() maybe lower than the actual because the zero padding will also be accounted.","markups":[]},{"name":"3bab","type":9,"text":"Similarly the max pooling taken by F.adaptive_max_pool1d() maybe higher than the actual because if the hidden state contains negative value then with zero padding, zero will be taken as max instead of negative value (refer output below)","markups":[]},{"name":"5a43","type":9,"text":"I have calculated the actual max and avg pooling below (refer below code line 25, 33). I got a slight increase in accuracy compared to pytorch adaptive max./avg pooling, but my approach is quite slow. I don’t know if there exists an elegant solution to this.","markups":[]},{"name":"b5b2","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"0273df26df01f64214f6f7ec62f5786f","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F11581552%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ce07","type":8,"text":"Adaptive avg pooling Variable containing:\n-0.1657  0.3532 -0.2512 -0.0778 -0.5564\n 0.2315  0.1153 -0.1446  0.3549 -0.0534\n 0.1212  0.1945 -0.1012  0.2525 -0.1593\n[torch.FloatTensor of size 3x5]\n\nBy hand Adaptive avg pooling Variable containing:\n-0.1657  0.3532 -0.2512 -0.0778 -0.5564\n 0.2646  0.1318 -0.1653  0.4056 -0.0610\n 0.1939  0.3112 -0.1619  0.4040 -0.2549\n[torch.FloatTensor of size 3x5]\n\nAdaptive max pooling Variable containing:\n 0.4062  0.5081  0.1206  0.2272 -0.0184\n 0.5597  0.4545  0.2079  0.5897  0.4978\n 0.3965  0.5072  0.1130  0.5585  0.0000\n[torch.FloatTensor of size 3x5]\n\nBy hand Adaptive max pooling Variable containing:\n 0.4062  0.5081  0.1206  0.2272 -0.0184\n 0.5597  0.4545  0.2079  0.5897  0.4978\n 0.3965  0.5072  0.1130  0.5585 -0.0092\n[torch.FloatTensor of size 3x5]","markups":[]},{"name":"4a60","type":1,"text":"You can compare the output of F.adaptive_max_pool1d() and max pooling by hand (custom code) in the above output. The max pooling by hand contains negative value as the max value while it is zero with F.adaptive_max_pool1d().","markups":[]},{"name":"43f8","type":13,"text":"Ways to improve accuracy","markups":[]},{"name":"a3e9","type":1,"text":"The accuracy I got on training set with above setup is ~81%. There are a lot of ways to improve it.","markups":[]},{"name":"feac","type":9,"text":"Include validation set for better accuracy measure","markups":[]},{"name":"fd02","type":9,"text":"Better preprocessing","markups":[]},{"name":"e04a","type":9,"text":"More hidden units","markups":[]},{"name":"2906","type":9,"text":"Pretrained word/char embeddings e.g. Glove, Fasttext, Word2vec","markups":[]},{"name":"d520","type":9,"text":"Regularization e.g. Dropout","markups":[]},{"name":"0ea0","type":9,"text":"Better model e.g. Bidirectional GRU, GRU with attention","markups":[]},{"name":"219b","type":6,"text":"In the next post I will cover Pytorch Text (torchtext) and how it can solve some of the problems we faced with much less code. Also, I will include the above mentioned tips to improve accuracy.","markups":[{"type":3,"start":7,"end":16,"href":"https://medium.com/@sonicboom8/sentiment-analysis-torchtext-55fb57b1fab8","title":"","rel":"","anchorType":0}]},{"name":"61c3","type":1,"text":"This is my first blog post. Please correct me if you find any mistake or if I have left out any reference.","markups":[]},{"name":"9bbf","type":3,"text":"References","markups":[]},{"name":"8104","type":1,"text":"[1] http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/ \n[2] http://thinknook.com/wp-content/uploads/2012/09/Sentiment-Analysis-Dataset.zip \n[3] https://stackoverflow.com/questions/46387661/how-to-correctly-implement-a-batch-input-lstm-network-in-pytorch \n[4] https://colah.github.io/posts/2015-08-Understanding-LSTMs/ \n[5] https://arxiv.org/abs/1801.06146","markups":[{"type":3,"start":4,"end":87,"href":"http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":93,"end":171,"href":"http://thinknook.com/wp-content/uploads/2012/09/Sentiment-Analysis-Dataset.zip","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":177,"end":286,"href":"https://stackoverflow.com/questions/46387661/how-to-correctly-implement-a-batch-input-lstm-network-in-pytorch","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":292,"end":350,"href":"https://colah.github.io/posts/2015-08-Understanding-LSTMs/","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":356,"end":388,"href":"https://arxiv.org/abs/1801.06146","title":"","rel":"nofollow","anchorType":0}]}],"sections":[{"name":"abd5","startIndex":0},{"name":"a627","startIndex":1},{"name":"cf7c","startIndex":9}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg","filter":"","backgroundSize":"","originalWidth":1280,"originalHeight":720,"strategy":"resample","height":0,"width":0},"wordCount":1083,"imageCount":7,"readingTime":5.136792452830188,"subtitle":"The Motivation","usersBySocialRecommends":[],"noIndex":false,"recommends":12,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"machine-learning","name":"Machine Learning","postCount":48623,"metadata":{"postCount":48623,"coverImage":{"id":"1*jnZT4gFAzScOJ_VnYsni0g.png","originalWidth":700,"originalHeight":450,"isFeatured":true}},"type":"Tag"},{"slug":"deep-learning","name":"Deep Learning","postCount":11628,"metadata":{"postCount":11628,"coverImage":{"id":"1*fiYPinouczFoVeB6KYqs9Q.gif","originalWidth":1152,"originalHeight":864,"isFeatured":true}},"type":"Tag"},{"slug":"pytorch","name":"Pytorch","postCount":278,"metadata":{"postCount":278,"coverImage":{"id":"0*-NuARKc7LqnL5KVU","originalWidth":394,"originalHeight":310,"isFeatured":true}},"type":"Tag"},{"slug":"nlp","name":"NLP","postCount":2785,"metadata":{"postCount":2785,"coverImage":{"id":"1*uYHdWYGan1kfOaiu7EF03Q.png","originalWidth":1920,"originalHeight":1280,"isFeatured":true}},"type":"Tag"},{"slug":"sentiment-analysis","name":"Sentiment Analysis","postCount":524,"metadata":{"postCount":524,"coverImage":{"id":"1*TmGtC3uYZboHh8GIG4N5tA.png","originalWidth":1276,"originalHeight":786,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":2,"links":{"entries":[{"url":"https://arxiv.org/abs/1801.06146","alts":[],"httpStatus":200},{"url":"http://thinknook.com/wp-content/uploads/2012/09/Sentiment-Analysis-Dataset.zip","alts":[],"httpStatus":200},{"url":"https://colah.github.io/posts/2015-08-Understanding-LSTMs/","alts":[],"httpStatus":200},{"url":"http://pytorch.org/tutorials/beginner/data_loading_tutorial.html","alts":[],"httpStatus":200},{"url":"http://pytorch.org/docs/stable/data.html","alts":[],"httpStatus":200},{"url":"http://pytorch.org/","alts":[],"httpStatus":200},{"url":"https://stackoverflow.com/questions/46387661/how-to-correctly-implement-a-batch-input-lstm-network-in-pytorch","alts":[],"httpStatus":200},{"url":"http://pytorch.org/docs/stable/nn.html#pack-padded-sequence","alts":[],"httpStatus":200},{"url":"https://medium.com/@sonicboom8/sentiment-analysis-torchtext-55fb57b1fab8","alts":[{"type":2,"url":"medium://p/55fb57b1fab8"},{"type":3,"url":"medium://p/55fb57b1fab8"}],"httpStatus":200},{"url":"http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/","alts":[],"httpStatus":200},{"url":"https://github.com/hpanwar08/sentence-classification-pytorch","alts":[],"httpStatus":200},{"url":"https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1524931149233},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":21,"sectionCount":3,"readingList":0,"topics":[]},"coverless":true,"slug":"sentiment-analysis-with-variable-length-sequences-in-pytorch","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*qJggHpIPUkkzG0KQZ-EUcQ.jpeg","originalWidth":1280,"originalHeight":720,"isFeatured":true}},{"name":"fc81","type":3,"text":"Sentiment Analysis with Variable length sequences in Pytorch","markups":[],"alignment":1},{"name":"afc6","type":3,"text":"The Motivation","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"The Motivation"},"license":1,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130","mediumUrl":"https://medium.com/@sonicboom8/sentiment-analysis-with-variable-length-sequences-in-pytorch-6241635ae130","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"isElevate":false,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"type":"Post"},"mentionedUsers":[],"collaborators":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"1f591fd38584":{"userId":"1f591fd38584","name":"Himanshu","username":"sonicboom8","createdAt":1499184020948,"lastPostCreatedAt":1534333182174,"imageId":"1*mhNhw1OcFVtR_RA76EvM9w.jpeg","backgroundImageId":"","bio":"Machine Learning / Deep Learning","twitterScreenName":"","socialStats":{"userId":"1f591fd38584","usersFollowedCount":23,"usersFollowedByCount":16,"type":"SocialStats"},"social":{"userId":"lo_dnt_K1OZNZxyCXTi","targetUserId":"1f591fd38584","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isPartnerProgramEnrolled":false,"type":"User"}},"Social":{"1f591fd38584":{"userId":"lo_dnt_K1OZNZxyCXTi","targetUserId":"1f591fd38584","type":"Social"}},"SocialStats":{"1f591fd38584":{"userId":"1f591fd38584","usersFollowedCount":23,"usersFollowedByCount":16,"type":"SocialStats"}}}})
// ]]></script><script type="text/javascript">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true}, function(err, data) {});</script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/main-common-async.bundle.ybn8pINumuGVGI-wY651qA.js"></script><script charset="UTF-8" src="./Sentiment Analysis with Variable length sequences in Pytorch_files/main-notes.bundle.4Hcf4I6qAbwXHFjEyhPyAg.js"></script></body></html>